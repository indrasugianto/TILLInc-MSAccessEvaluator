SELECT DISTINCTROW [>Payroll Query].ADPName AS Expr1, [>Payroll Query].ADPFile, [>Payroll Query].ADPNetAccount AS Expr2, Max([>Payroll Query].EmploymentDate) AS MaxOfEmploymentDate, Max([>Payroll Query].TerminationDate) AS MaxOfTerminationDate, [>Payroll Query].BonusPlan AS Expr3, Sum([>Payroll Query].Regular) AS SumOfRegular, Sum([>Payroll Query].Retroactive) AS SumOfRetroactive, Sum([>Payroll Query].Vacation) AS SumOfVacation, Sum([>Payroll Query].Holiday) AS SumOfHoliday, Sum([>Payroll Query].OverTime) AS SumOfOverTime, Sum(NNEZ([Regular])-NNEZ([Overtime])) AS NetNet, Sum(NNEZ([Regular])+NNEZ([Retroactive])+NNEZ([Vacation])+NNEZ([Holiday])) AS NetPay, IIf([Vested]>0,(NNEZ([NetPay])/20*Localvariable("Form_BonusPlan_CSQ"))*[Vested]\1,0) AS CSQBonus, Max(IIf(DateDiff("d",[EmploymentDate],Forms!Payroll!Todate)<455,(DateDiff("d",[EmploymentDate],Forms!Payroll!Todate)-90)/DateDiff("d",[EmploymentDate],Forms!Payroll!Todate),1)) AS Vested, Max(IIf(DateDiff("d",[EmploymentDate],Forms!Payroll!Todate)<455,DateDiff("d",[EmploymentDate],Forms!Payroll!Todate)-90,"")) AS Days, IIf(IsNull([maxofterminationDate]),[maxofemploymentdate],"Terminated") AS HiredDate
FROM [>Payroll Query]
WHERE (((IIf(NNEZ([TerminationDate])=0,True,IIf(DateDiff("d",[EmploymentDate],[TerminationDate])<=90,False,True)))=True) And (([>Payroll Query].ADPFile)>3) And (([>Payroll Query].WitholdingAccount)>0))
GROUP BY [>Payroll Query].ADPName, [>Payroll Query].ADPFile, [>Payroll Query].ADPNetAccount, [>Payroll Query].BonusPlan
HAVING ((([>Payroll Query].BonusPlan)=True))
ORDER BY [>Payroll Query].ADPName;