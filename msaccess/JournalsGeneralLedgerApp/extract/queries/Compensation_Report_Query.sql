SELECT DISTINCTROW Sum([>Payroll Query].Gross) AS SumOfGross, Sum([>Payroll Query].Bonus) AS SumOfBonus, Sum([>Payroll Query].Vacation) AS SumOfVacation, Sum([>Payroll Query].RetroactiveVacation) AS SumOfRetroactiveVacation, [>Payroll Employer Tax].Employertax, Sum([>Payroll Query].Holiday) AS SumOfHoliday, Sum([>Payroll Query].Medicare) AS SumOfMedicare, Sum([>Payroll Query].RetroactiveHoliday) AS SumOfRetroactiveHoliday, [>Payroll Benefit Medical].MedicalAmount, [>Payroll Benefit AFLAC].AFLACAmount, [>Payroll Benefit FSA].FSAAmount, Sum([>Payroll Query].SocialSecurity) AS SumOfSocialSecurity, Sum([>Payroll Query].Field1) AS SumOfField1, Sum([>Payroll Query].Field3) AS SumOfField3, Sum([>Payroll Query].Commission) AS SumOfCommission, Sum([>Payroll Query].OverTime) AS SumOfOverTime, [MIS Personnel].ADPNetAccount, IIf([mis personnel].ADPNetAccount>700,[sumofgross]*Variable("WorkmansCompOffice"),IIf([mis personnel].ADPNetAccount>600,[sumofgross]*Variable("WorkmansCompInstall"),[sumofgross]*Variable("WorkmansCompShop"))) AS workmanscomp, [sumofgross]*Variable("Unemployment") AS unemployment, [sumoffield3]-[sumofcommission] AS Retirement, IIf([Retirement]=0,0,IIf([Retirement]<=([sumofGross]-[sumofbonus])*Variable("RetirementThreshold"),[Retirement]*Variable("RetirementMatch"),([sumofgross]-[sumofbonus])*Variable("RetirementThreshold")*Variable("RetirementMatch"))) AS MatchingRetirement, [sumofholiday]+[sumofretroactiveholiday] AS TotalHoliday, [sumofvacation]+[sumofretroactivevacation] AS TotalVacation, [sumoffield1] AS TotalMedical, [sumofVacation]+NNEZ([sumofretroactivevacation])+NNEZ([sumofholiday])+NNEZ([sumofretroactiveholiday])+nnez([sumofsocialsecurity])+nnez([sumofmedicare])+nnez([matchingretirement])+nnez([medicalamount])+nnez([workmanscomp])+nnez([unemployment]+nnez([sumofbonus])) AS KRHContribution, [sumofgross]-[sumofovertime]-[sumofbonus] AS Pay, [sumofovertime] AS Overtime, [Pay]+[Overtime]+[krhcontribution] AS Total
FROM (((([>Payroll Query] LEFT JOIN [MIS Personnel] ON [>Payroll Query].ADPFile=[MIS Personnel].ADPFile) LEFT JOIN [>Payroll Benefit AFLAC] ON [MIS Personnel].ADPFile=[>Payroll Benefit AFLAC].ADPFile) LEFT JOIN [>Payroll Benefit FSA] ON [MIS Personnel].ADPFile=[>Payroll Benefit FSA].ADPFile) LEFT JOIN [>Payroll Benefit Medical] ON [MIS Personnel].ADPFile=[>Payroll Benefit Medical].ADPFile) LEFT JOIN [>Payroll Employer Tax] ON [MIS Personnel].ADPFile=[>Payroll Employer Tax].ADPFile
WHERE ((([>Payroll Query].Void)=False))
GROUP BY [>Payroll Employer Tax].Employertax, [>Payroll Benefit Medical].MedicalAmount, [>Payroll Benefit AFLAC].AFLACAmount, [>Payroll Benefit FSA].FSAAmount, [MIS Personnel].ADPNetAccount;