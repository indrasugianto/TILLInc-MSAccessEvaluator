SELECT DISTINCTROW [WIP Report Job Query].ID, [WIP Report Cabinet Sales Query].SumOfSaleAmount, [WIP Report Cabinet Invoice Query].SumOfSaleAmount, [WIP Report Install Sales Query].SumOfSaleAmount, [WIP Report Install Invoice Query].SumOfSaleAmount, [WIP Report Cabinet Sales Query].SumOfSaleAmount AS SoldCabinets, [WIP Report Install Sales Query].SumOfSaleAmount AS SoldInstallation, [WIP Report Cabinet Invoice Query].SumOfSaleAmount-NNEZ([WIP Report Cabinet Sales Query].sumofsaleamount) AS UnsoldCabinets, [WIP Report Install Invoice Query].SumOfSaleAmount-NNEZ([WIP Report Install Sales Query].sumofsaleamount) AS UnsoldInstallation, [WIP Report Query].SumOfHours, [WIP Report Query].SumOfCost, [WIP Report Install Query].SumOfHours, [WIP Report Install Query].SumOfCost, [WIP Report Design Query].SumOfHours, IIf(NNEZ([WIP Report Cabinet Invoice Query].SumOfSaleAmount)=0,0,IIf(NNEZ([WIP Report Install Query].SumOfHours)<>0 And NNEZ([WIP Report Query].SumOfHours)<>0,1,IIf(NNEZ([WIP Report Query].SumOfHours)<>0,2,3))) AS CabinetSale
FROM ((((((([WIP Report Job Query] LEFT JOIN [WIP Report Install Query] ON [WIP Report Job Query].ID=[WIP Report Install Query].ID) LEFT JOIN [WIP Report Query] ON [WIP Report Job Query].ID=[WIP Report Query].ID) LEFT JOIN [WIP Report Design Query] ON [WIP Report Job Query].ID=[WIP Report Design Query].ID) LEFT JOIN [>Resources] ON [WIP Report Job Query].Customer=[>Resources].Key) LEFT JOIN [WIP Report Cabinet Sales Query] ON [WIP Report Job Query].Key=[WIP Report Cabinet Sales Query].Key) LEFT JOIN [WIP Report Cabinet Invoice Query] ON [WIP Report Job Query].Key=[WIP Report Cabinet Invoice Query].Key) LEFT JOIN [WIP Report Install Sales Query] ON [WIP Report Job Query].Key=[WIP Report Install Sales Query].Key) LEFT JOIN [WIP Report Install Invoice Query] ON [WIP Report Job Query].Key=[WIP Report Install Invoice Query].Key
WHERE ((([WIP Report Install Query]!SumofCost<>0 Or [WIP Report Query]!SumofCost<>0 Or [WIP Report Design Query]!SumofHours<>0)=True) And ((InStr([>resources].ID,"KR+H"))=0))
GROUP BY [WIP Report Job Query].ID, [WIP Report Cabinet Sales Query].SumOfSaleAmount, [WIP Report Cabinet Invoice Query].SumOfSaleAmount, [WIP Report Install Sales Query].SumOfSaleAmount, [WIP Report Install Invoice Query].SumOfSaleAmount, [WIP Report Query].SumOfHours, [WIP Report Query].SumOfCost, [WIP Report Install Query].SumOfHours, [WIP Report Install Query].SumOfCost, [WIP Report Design Query].SumOfHours
HAVING (((IIf(NNEZ([WIP Report Cabinet Invoice Query].SumOfSaleAmount)=0,0,IIf(NNEZ([WIP Report Install Query].SumOfHours)<>0 And NNEZ([WIP Report Query].SumOfHours)<>0,1,IIf(NNEZ([WIP Report Query].SumOfHours)<>0,2,3))))<>3))
ORDER BY [WIP Report Job Query].ID;