SELECT DISTINCTROW [General Ledger].TransactionDate, [General Ledger].AccountNumber, Sum([General Ledger].CreditAmount) AS SumOfCreditAmount, Sum([General Ledger].DebitAmount) AS SumOfDebitAmount, IIf(Forms!GeneralLedger!SelectPayee,IIf(Forms!GeneralLedger!SelectedPayee=[SourceOperative],True,False),True) AS Expr1, Min([MIS Accounts].Balance) AS MinOfBalance, IIf(Forms!GeneralLedger!SelectJournal,IIf(Forms!GeneralLedger!SelectedJournal=[SourceJournal],True,False),True) AS Expr2
FROM ([General Ledger] LEFT JOIN [>Resources] ON [General Ledger].SourceOperative=[>Resources].Key) LEFT JOIN [MIS Accounts] ON [General Ledger].AccountNumber=[MIS Accounts].Number
GROUP BY [General Ledger].TransactionDate, [General Ledger].AccountNumber, IIf(Forms!GeneralLedger!SelectPayee,IIf(Forms!GeneralLedger!SelectedPayee=[SourceOperative],True,False),True), IIf(Forms!GeneralLedger!SelectJournal,IIf(Forms!GeneralLedger!SelectedJournal=[SourceJournal],True,False),True)
HAVING ((([General Ledger].TransactionDate)>=forms!GeneralLedger!FromDate And ([General Ledger].TransactionDate)<=forms!GeneralLedger!ToDate) And (([General Ledger].AccountNumber)=forms!GeneralLedger!selectedaccount) And ((IIf(Forms!GeneralLedger!SelectPayee,IIf(Forms!GeneralLedger!SelectedPayee=[SourceOperative],True,False),True))=True) And ((IIf(Forms!GeneralLedger!SelectJournal,IIf(Forms!GeneralLedger!SelectedJournal=[SourceJournal],True,False),True))=True))
ORDER BY [General Ledger].TransactionDate;