SELECT DISTINCTROW [MIS Hours].Date, [MIS Hours].Employee, [MIS Personnel].ADPNetAccount, [MIS Hours].Activity, [MIS Hours].General, [MIS Hours].[Job ID], [MIS Hours].Charge, [MIS Hours].Hours, [MIS Hours].ADPFile, [MIS Hours].Key, [MIS Hours].Cost, [MIS Hours].Rate, [>Jobs].ID AS Job, IIf(IsNull([Activity]),[General],[Activity]) AS AorG, IIf(Not IsNull([General]),0,IIf([ADPNetAccount]>=700,variable("office hrly cost estimate")*[Hours],variable("shop hrly cost estimate")*[Hours])) AS CostPlus, IIf([ADPNetAccount]>=700,variable("office hrly cost estimate")*[Hours],variable("shop hrly cost estimate")*[Hours]) AS HourlyCost
FROM ([MIS Hours] LEFT JOIN [>Jobs] ON [MIS Hours].[Job ID]=[>Jobs].Key) LEFT JOIN [MIS Personnel] ON [MIS Hours].Employee=[MIS Personnel].Employee
WHERE ((([MIS Hours].Date)>=Format(Forms!Hours!Todate,"mm/dd/" & Year(Forms!Hours!DateSort)-1) And ([MIS Hours].Date)<=forms!Hours!ToDate) And (([MIS Hours].Hours)<>0) And ((InStr(1,[Activity],LocalVariable("Form_Hours_ActivitySort"),0))<>0))
ORDER BY [MIS Hours].Date;