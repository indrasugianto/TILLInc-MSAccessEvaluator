SELECT DISTINCTROW [General Ledger Income Statement].Index, [General Ledger Income Statement].Heading, [General Ledger Income Statement].SubHeading, [General Ledger Income Statement].SubSubHeading, [General Ledger Income Statement].[Index Income], [General Ledger Income Statement].[Index Expense], [General Ledger Income Statement Account Order].Account, nnez([SumOfCreditAmount]) AS TheCredit, nnez([SumOfDebitAmount]) AS TheDebit, nnez([sumofcreditamount])-nnez([sumofdebitamount]) AS TheNet, setlocalvariableFunction("GL_SubSubTotal",[TheNet]+nnez(Localvariable("GL_SubSubTotal"))) AS SubTotal
FROM [General Ledger Income Statement] LEFT JOIN [General Ledger Income Statement Account Order] ON [General Ledger Income Statement].Index=[General Ledger Income Statement Account Order].BalanceSheetItemSort
GROUP BY [General Ledger Income Statement].Index, [General Ledger Income Statement].Heading, [General Ledger Income Statement].SubHeading, [General Ledger Income Statement].SubSubHeading, [General Ledger Income Statement].[Index Income], [General Ledger Income Statement].[Index Expense], [General Ledger Income Statement Account Order].Account, nnez([SumOfCreditAmount]), nnez([SumOfDebitAmount]);