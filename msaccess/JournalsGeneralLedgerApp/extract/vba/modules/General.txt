Option Compare Database
Option Explicit

Public Function UpdateCurrentFiscalYearBalance(iNumber As Integer)
On Error GoTo ERR_HANDLER:
Dim sql As String
Dim NewRetainedEarningbalance As Currency
Dim NewBalance As String
Dim rs As DAO.Recordset
Dim rv As Boolean

    rv = False

    sql = ""
    sql = sql & "Select Account from [MIS Accounts] where Number = " & iNumber
    
    Set rs = CurrentDb.OpenRecordset(sql, dbOpenDynaset, dbSeeChanges)
    
    If rs.EOF Then
        MsgBox "Can't find the GL Account!", vbCritical
        rv = False
        GoTo EXIT_HANDLER
    End If
    
    If MsgBox("Do you want to update " & rs("Account") & " balance of the current fiscal year?", vbYesNo) = vbYes Then
        Do While Not VBA.IsNumeric(NewBalance)
            NewBalance = InputBox("Specifiy the new " & rs("Account") & " balance (*Note: spefiying 0 will not update the balance)", "Update Account 296", 0)
            
            If VBA.IsNumeric(NewBalance) Then
                If NewBalance = 0 Then
                    Exit Function
                End If
            Else
                MsgBox "Please specify a valid balance amount"
            End If
        Loop
        NewRetainedEarningbalance = -CCur(NewBalance)
        
        If MsgBox("Do you want to overwrite the " & rs("Account") & " balance to " & Format(CStr(NewRetainedEarningbalance), "currency"), vbYesNo) = vbYes Then

            sql = ""
            sql = sql & "Update [MIS Accounts] "
            sql = sql & "Set Balance = " & NewRetainedEarningbalance & " "
            sql = sql & "Where Number = " & iNumber
            
            CurrentDb.Execute sql
            
            MsgBox "The new " & rs("Account") & " balance is " & Format(CStr(NewRetainedEarningbalance), "currency")
            rv = True
        End If
    End If
EXIT_HANDLER:
    UpdateCurrentFiscalYearBalance = rv
    Exit Function
ERR_HANDLER:
    MsgBox Error
    rv = False
    Resume EXIT_HANDLER
End Function

Public Function UpdateCurrentFiscalRetainedEarningBalance()
    If Not UpdateCurrentFiscalYearBalance(296) Then
        MsgBox "Fail to update Retained Earning Balance"
    End If
End Function