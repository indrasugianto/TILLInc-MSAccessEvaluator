SELECT DISTINCTROW [>Jobs].ID, [>Jobs].Key, [>Jobs].EntryDate, [>Jobs].Preliminary, [Job Agreement Sales NIC Stone].SumOfSaleAmount AS Agreement, IIf(NNEZ([>Receivables Query].Days)<>0,[>Receivables Query].Days & " d","") AS Receivable, IIf([>Receivables Query].Owed<>0,[>Receivables Query].Owed,"") AS Owed, [Job Project Hours].SumOfHours AS OfficeHours, [>Job Receipts Query].SumOfAmount AS OnAccount, [Job Project Hours].TotalCost AS OfficeCost, [>Jobs].ProductionPhase, [MIS Personnel_1].Employee, [MIS Personnel_3].Text1 AS Partner, [MIS Personnel_1].Text1 AS Manager, [>Jobs].ManagedBy, [>Jobs].SpecifiedBy, [>Jobs].Estimate, NNEZ([>Job Receipts Query].SumOfAmount)+NNEZ([>Receivables Query].Owed)-[Job Project Hours].TotalCost AS Underfunded, IIf(NNEZ([>Job Receipts Query].SumOfAmount)+NNEZ([>Receivables Query].Owed)<[Job Project Hours].TotalCost,True,IIf(NNEZ([>Receivables Query].Days)>30 And NNEZ([>Job Receipts Query].SumOfAmount)<[Job Project Hours].TotalCost,True,False)) AS Expr1, IIf(NNEZ([>Job Receipts Query].SumOfAmount)+NNEZ([>Receivables Query].Owed)=0,(30-DateDiff("d",[>Jobs].EntryDate,Now()))*-1,Null) AS GracePeriod
FROM ((((([>Jobs] LEFT JOIN [MIS Personnel] AS [MIS Personnel_1] ON [>Jobs].SpecifiedBy=[MIS Personnel_1].Key) LEFT JOIN [>Job Receipts Query] ON [>Jobs].Key=[>Job Receipts Query].Key) LEFT JOIN [>Receivables Query] ON [>Jobs].Key=[>Receivables Query].Key) LEFT JOIN [MIS Personnel] AS [MIS Personnel_3] ON [>Jobs].ManagedBy=[MIS Personnel_3].Key) LEFT JOIN [Job Agreement Sales NIC Stone] ON [>Jobs].Key=[Job Agreement Sales NIC Stone].Key) LEFT JOIN [Job Project Hours] ON [>Jobs].Key=[Job Project Hours].Key
WHERE ((([>Jobs].ProductionPhase)<>"Completed" And ([>Jobs].ProductionPhase)<>"Archive") And (([>Jobs].Estimate)=False) And ((IIf(NNEZ([>Job Receipts Query].SumOfAmount)+NNEZ([>Receivables Query].Owed)<[Job Project Hours].TotalCost,True,IIf(NNEZ([>Receivables Query].Days)>30 And NNEZ([>Job Receipts Query].SumOfAmount)<[Job Project Hours].TotalCost,True,False)))=True) And (([>Jobs].Closed)=False));