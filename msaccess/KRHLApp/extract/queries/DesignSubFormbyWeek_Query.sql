SELECT [MIS Hours].Date, [MIS Hours].Employee, Sum([MIS Hours].Hours) AS SumOfHours, [MIS Hours].DesignNote, [DesignSubFormCurrentbyRate Query].CurrentDesignCost, [DesignSubFormPreviousbyRate Query].PreviousDesignCost, Min([DesignSubFormPreviousbyRate Query].PreviousDate) AS MinofDate, IIf([Date]>=Forms!Sales!FromDate And [Date]<=Forms!Sales!toDate,"Current Period","Previous Periods") AS ThePeriod, Previousday(Forms!Sales!fromdate) AS maxofdate, [MIS Hours].Archive, [>Design Rate].DesignRate, [MIS Hours].Monday, [MIS Hours].Tuesday, [MIS Hours].Wednesday, [MIS Hours].Thursday, [MIS Hours].Friday, [MIS Hours].Saturday, [MIS Hours].Sunday, Sum([Hours]*[DesignRate]) AS DesignCost, [MIS Hours].MondayNote, [MIS Hours].TuesdayNote, [MIS Hours].WednesdayNote, [MIS Hours].ThursdayNote, [MIS Hours].FridayNote, [MIS Hours].SaturdayNote, [MIS Hours].SundayNote
FROM (([>Jobs] LEFT JOIN [DesignSubFormCurrentbyRate Query] ON [>Jobs].Key=[DesignSubFormCurrentbyRate Query].Key) LEFT JOIN [DesignSubFormPreviousbyRate Query] ON [>Jobs].Key=[DesignSubFormPreviousbyRate Query].Key) LEFT JOIN ([MIS Hours] LEFT JOIN [>Design Rate] ON [MIS Hours].Employee=[>Design Rate].Designer) ON [>Jobs].Key=[MIS Hours].[Job ID]
WHERE ((([>Jobs].Key)=forms!Sales!thejobname))
GROUP BY [MIS Hours].Date, [MIS Hours].Employee, [MIS Hours].DesignNote, [DesignSubFormCurrentbyRate Query].CurrentDesignCost, [DesignSubFormPreviousbyRate Query].PreviousDesignCost, IIf([Date]>=Forms!Sales!FromDate And [Date]<=Forms!Sales!toDate,"Current Period","Previous Periods"), [MIS Hours].Archive, [>Design Rate].DesignRate, [MIS Hours].Monday, [MIS Hours].Tuesday, [MIS Hours].Wednesday, [MIS Hours].Thursday, [MIS Hours].Friday, [MIS Hours].Saturday, [MIS Hours].Sunday, [MIS Hours].MondayNote, [MIS Hours].TuesdayNote, [MIS Hours].WednesdayNote, [MIS Hours].ThursdayNote, [MIS Hours].FridayNote, [MIS Hours].SaturdayNote, [MIS Hours].SundayNote, [MIS Hours].Date
HAVING ((([MIS Hours].Date)<=forms!sales!Todate And ([MIS Hours].Date)>=forms!sales!Fromdate))
ORDER BY [MIS Hours].Date, [MIS Hours].Employee, [MIS Hours].Date, IIf([Date]>=Forms!Sales!FromDate And [Date]<=Forms!Sales!toDate,"Current Period","Previous Periods") DESC , [>Design Rate].DesignRate;