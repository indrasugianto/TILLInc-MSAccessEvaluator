SELECT DISTINCTROW [>Jobs].ID AS Job, [>Jobs].Key, IIf(Not IsNull([Completed]),[Phase] & " " & [Completed],[ProductionPhase]) AS Currently, Format([SumOfSaleAmount],"#,#") AS Agreement, Max([Sales Journal].Due) AS [Last Invoice], IIf([DesignJob],"Design","") AS Design, IIf([Estimate]<>0,"Estimate","") AS Estimates, IIf([Family],"Parent",IIf(nnez([Parent])<>0,"Child","")) AS [Parent/Child], [>Jobs].Delivered, [>Jobs].Customer, [>Jobs].Estimate, [>Jobs].Owner
FROM (([>Jobs] LEFT JOIN [>Settings] ON [>Jobs].ProductionPhase=[>Settings].Phase) LEFT JOIN [Job Agreement Sales] ON [>Jobs].Key=[Job Agreement Sales].Key) LEFT JOIN [Sales Journal] ON [>Jobs].Key=[Sales Journal].Job
WHERE ((([>Jobs].Family)=False))
GROUP BY [>Jobs].ID, [>Jobs].Key, IIf(Not IsNull([Completed]),[Phase] & " " & [Completed],[ProductionPhase]), Format([SumOfSaleAmount],"#,#"), IIf([DesignJob],"Design",""), IIf([Estimate]<>0,"Estimate",""), IIf([Family],"Parent",IIf(nnez([Parent])<>0,"Child","")), [>Jobs].Delivered, [>Jobs].Customer, [>Jobs].Estimate, [>Jobs].Owner, [>Jobs].Closed, [>Settings].PhaseSort, IIf(nnez([Completed])<>0,[completed],#1/1/2099#), [>Jobs].ID
HAVING ((([>Jobs].ID) Is Not Null) AND ((IIf(Not IsNull([Completed]),[Phase] & " " & [Completed],[ProductionPhase])) Is Not Null) AND (([>Jobs].Customer)<>0) AND (([>Jobs].Closed)=False))
ORDER BY IIf([DesignJob],"Design",""), IIf([Estimate]<>0,"Estimate",""), [>Settings].PhaseSort, IIf(nnez([Completed])<>0,[completed],#1/1/2099#) DESC , [>Jobs].ID;