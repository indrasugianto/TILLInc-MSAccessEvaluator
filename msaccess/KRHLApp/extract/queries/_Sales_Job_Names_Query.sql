SELECT DISTINCTROW [>Jobs].ID AS Job, [>Jobs].Key, [>Jobs].ProductionPhase AS Currently, SaleorAmountorTotal.Total AS [Sale or Amount], IIf([DesignJob] And Not [estimate],"Design",IIf([Estimate] And Not [designjob],"Estimate",IIf([Estimate] And [designjob],"Design Estimate",""))) AS [Job Type], IIf([Family],"Parent",IIf(nnez([Parent])<>0,"Child","")) AS [Parent/Child], [>Jobs].Family, [MIS Personnel].Text1 & "/" & [MIS Personnel_1].text1 AS Team, [>Jobs].Closed
FROM ((([>Jobs] LEFT JOIN [>Resources] ON [>Jobs].Customer=[>Resources].Key) LEFT JOIN [MIS Personnel] ON [>Jobs].ManagedBy=[MIS Personnel].Key) LEFT JOIN [MIS Personnel] AS [MIS Personnel_1] ON [>Jobs].SpecifiedBy=[MIS Personnel_1].Key) LEFT JOIN SaleorAmountorTotal ON [>Jobs].Key=SaleorAmountorTotal.Key
WHERE (((IIf(Forms!Sales.SelectPartnerManager,IIf([Managedby]=Forms!Sales.PartnerManagerSelection Or [Specifiedby]=Forms!Sales.PartnerManagerSelection,True,False),True))=True) And ((IIf(InStr(forms!Sales!JobView,"all")<>0,True,IIf(InStr(forms!Sales!JobView,"Design")<>0 And [DesignJob],True,IIf(InStr(Forms!Sales!JobView,"Estimate")<>0 And [Estimate],True,False))))=True))
GROUP BY [>Jobs].ID, [>Jobs].Key, [>Jobs].ProductionPhase, SaleorAmountorTotal.Total, IIf([DesignJob] And Not [estimate],"Design",IIf([Estimate] And Not [designjob],"Estimate",IIf([Estimate] And [designjob],"Design Estimate",""))), IIf([Family],"Parent",IIf(nnez([Parent])<>0,"Child","")), [>Jobs].Family, [MIS Personnel].Text1 & "/" & [MIS Personnel_1].text1, [>Jobs].Closed, [>Jobs].Estimate, [>Jobs].ManagedBy, [>Jobs].SpecifiedBy
HAVING ((([>Jobs].Closed)=IIf(InStr(Forms!Sales!viewClosed,"Open"),False,True)))
ORDER BY [>Jobs].ID
WITH OWNERACCESS OPTION;