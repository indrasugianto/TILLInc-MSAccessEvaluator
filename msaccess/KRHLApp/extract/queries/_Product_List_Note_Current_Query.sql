SELECT DISTINCTROW [>Note].ID, [>Note].Note, [>Note].ProductListKey, IIf(Forms!NoteSearch!IDMatch="Whole Field" And [ID]=NNEN(Forms!NoteSearch!SearchID),True,False) AS Expr1
FROM [>Product List Note Headings Query] RIGHT JOIN [>Note] ON [>Product List Note Headings Query].MacroToRun=[>Note].ID
WHERE (((IIf(Forms!NoteSearch!ViewID="View Current" And Not IsNull([MacroToRun]),True,IIf(Forms!NoteSearch!ViewID<>"View Current",True,False)))=True) And ((IIf(IsNull(Forms!NoteSearch!SearchID),True,IIf(InStr([ID],Forms!NoteSearch!SearchID)<>0,True,False)))=True) And ((IIf(IsNull(Forms!NoteSearch!SearchNote),True,IIf(InStr([Note],Forms!NoteSearch!SearchNote)<>0,True,False)))=True) And ((IIf(Forms!NoteSearch!IDMatch="Whole Field" And [ID]=NNEN(Forms!NoteSearch!SearchID),True,False))=True)) Or (((IIf(Forms!NoteSearch!IDMatch="Whole Field" And (IIf(Forms!NoteSearch!IDMatch="Whole Field" And [ID]=NNEN(Forms!NoteSearch!SearchID),True,False))=IsNull([ID]) And (IIf(Forms!NoteSearch!IDMatch="Whole Field" And [ID]=NNEN(Forms!NoteSearch!SearchID),True,False))=IsNull(Forms!NoteSearch!SearchID),True,False))=True)) Or (((IIf(Forms!NoteSearch!IDMatch="Any Part of Field" And InStr([ID],NNEN(Forms!NoteSearch!SearchID))<>0,True,False))=True)) Or (((IIf(Forms!NoteSearch!IDMatch="Any Part of Field" And NNEN(Forms!NoteSearch!SearchID)="",True,False))=True)) Or (((IIf(Forms!NoteSearch!IDMatch="Start of Field" And InStr(Mid([ID],1,Len(NNEN(Forms!NoteSearch!SearchID))),NNEN(Forms!NoteSearch!SearchID))<>0,True,False))=True))
ORDER BY [>Note].ID
WITH OWNERACCESS OPTION;