SELECT DISTINCTROW [>Part List Whole Query].*, Components.Component, Activity.Activity, IIf(Forms!PartsList!SelectComponent And nnez([Processcomponent])<>Forms!PartsList!ComponentSort,False,True) AS ComponentSelect
FROM ([>Part List Whole Query] LEFT JOIN Activity ON [>Part List Whole Query].ProcessActivity=Activity.Key) LEFT JOIN Components ON [>Part List Whole Query].ProcessComponent=Components.key
WHERE (((IIf(Forms!PartsList!SelectComponent And nnez([Processcomponent])<>Forms!PartsList!ComponentSort,False,True))=True) And ((IIf(Forms!PartsList!SelectComponent And [Processcomponent]<>Forms!PartsList!ComponentSort,False,True))=True) And (([>Part List Whole Query].ProductList)=Forms!ProductListMaster!ProductListControl!ProductListName) And (([>Part List Whole Query].DisplayPart)=True Or ([>Part List Whole Query].DisplayPart)=False) And ((IIf(Forms!PartsList!ViewCNC And [cncsize] Or Forms!PartsList!ViewNonCNC And Not [CNCSize] Or forms!PartsList!ViewMaterialProcessCost And nnez([MaterialCost])<>0 Or forms!PartsList!ViewMaterialProcessCost And nnez([ProcessCost])<>0,True,False))=True))
ORDER BY [>Part List Whole Query].ItemNumber, [>Part List Whole Query].SubAssembly, [>Part List Whole Query].DefaultMaterial, [>Part List Whole Query].PartName, [>Part List Whole Query].Z DESC , [>Part List Whole Query].X DESC , [>Part List Whole Query].Y DESC
WITH OWNERACCESS OPTION;