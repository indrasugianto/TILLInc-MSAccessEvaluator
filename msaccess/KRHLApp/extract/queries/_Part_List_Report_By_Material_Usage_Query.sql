SELECT DISTINCTROW [>Part List].SubAssembly, [>Part List].DefaultMaterial, [>Part List].UsageUnit, Count([>Part List].DefaultMaterial) AS CountOfDefaultMaterial, [>Part List].PartProcessAlternate, Sum([>Part List].Quantity) AS SumOfQuantity, Sum(NNEZ([Quantity])) AS TotalQuantity, Sum([>Part List].MaterialCost) AS SumOfMaterialCost, IIf(InStr(Forms!PartsList!IncludeWaste,"Includ")<>0,Sum(NNEZ([MaterialCost])),Sum(IIf(nnez([materialcost])<>0,[materialcost]/(1+[waste]),0))) AS TotalMaterialCost, IIf(InStr(Forms!PartsList!IncludeWaste,"includ")<>0,Sum(IIf(nnez([materialcost])<>0,[materialcost]-[materialcost]/(1+[waste]),0)),0) AS TotalWaste, Max([>Part List].Waste) AS MaxOfWaste, Sum([>Part List].ProcessCost) AS SumOfProcessCost, Sum([>Part List].ProcessCostAlternate) AS SumOfProcessCostAlternate, Sum([>Part List].ProcessCost) AS TotalProcessCost, [>Part List].ProcessList, [>Part List].ShowPart, [>Part List].MaterialCategory, [>Part List].Item
FROM [>Part List]
GROUP BY [>Part List].SubAssembly, [>Part List].DefaultMaterial, [>Part List].UsageUnit, [>Part List].PartProcessAlternate, [>Part List].ProcessList, [>Part List].ShowPart, [>Part List].MaterialCategory, [>Part List].Item, [>Part List].ProductList, [>Part List].DisplayPart
HAVING ((([>Part List].ProductList)=Forms!ProductListMaster!ProductListControl!ProductListName) And (([>Part List].DisplayPart)=True))
ORDER BY [>Part List].SubAssembly, [>Part List].DefaultMaterial, [>Part List].UsageUnit
WITH OWNERACCESS OPTION;