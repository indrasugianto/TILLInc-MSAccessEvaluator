SELECT DISTINCTROW [>Product List].*, [>Products].Category, [>Product Lists].ProductList, [>Product Lists].Job, [>Products].Description, [>Product Lists].Text1, IIf(Not Forms!ProductListMaster!ProductListControl!SelectReference1,True,IIf([Reference1]=Forms!ProductListMaster!ProductListControl!Reference1Select,True,False)) AS Expr2, IIf(Not Forms!ProductListMaster!ProductListControl!SelectReference2,True,IIf([Reference2]=Forms!ProductListMaster!ProductListControl!Reference2Select,True,False)) AS Expr3, IIf(Not Forms!ProductListMaster!ProductListControl!SelectCategory1,True,IIf([Category]=Forms!ProductListMaster!ProductListControl!Category1Select,True,False)) AS Expr4, IIf(Not Forms!ProductListMaster!ProductListControl!SelectAlternate,True,IIf([Alternate]=Forms!ProductListMaster!ProductListControl!AlternateSelect,True,False)) AS Expr1
FROM ([>Product List] LEFT JOIN [>Products] ON [>Product List].Product = [>Products].Key) LEFT JOIN [>Product Lists] ON [>Product List].ProductListKey = [>Product Lists].Key
WHERE ((([>Product List].ProductListKey)=[Forms]![ProductListMaster]![ProductListControl]![ProductListName]) AND ((IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectAlternate],True,IIf([Alternate]=[Forms]![ProductListMaster]![ProductListControl]![AlternateSelect],True,False)))=True Or (IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectAlternate],True,IIf([Alternate]=[Forms]![ProductListMaster]![ProductListControl]![AlternateSelect],True,False)))=False) AND ((IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectFromTo],True,IIf([Item]>=[Forms]![ProductListMaster]![ProductListControl]![FromItem] And [Item]<=[Forms]![ProductListMaster]![ProductListControl]![ToItem],True,False)))=True Or (IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectFromTo],True,IIf([Item]>=[Forms]![ProductListMaster]![ProductListControl]![FromItem] And [Item]<=[Forms]![ProductListMaster]![ProductListControl]![ToItem],True,False)))=False) AND ((IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectReference1],True,IIf([Reference1]=[Forms]![ProductListMaster]![ProductListControl]![Reference1Select],True,False)))=True Or (IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectReference1],True,IIf([Reference1]=[Forms]![ProductListMaster]![ProductListControl]![Reference1Select],True,False)))=False) AND ((IIf([Forms]![ProductListMaster]![ProductListControl]![SelectReference2]=False,True,IIf([Reference2]=[Forms]![ProductListMaster]![ProductListControl]![Reference2Select],True,False)))=True Or (IIf([Forms]![ProductListMaster]![ProductListControl]![SelectReference2]=False,True,IIf([Reference2]=[Forms]![ProductListMaster]![ProductListControl]![Reference2Select],True,False)))=False) AND ((IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectCategory1],True,IIf([Category]=[Forms]![ProductListMaster]![ProductListControl]![Category1Select],True,False)))=True Or (IIf(Not [Forms]![ProductListMaster]![ProductListControl]![SelectCategory1],True,IIf([Category]=[Forms]![ProductListMaster]![ProductListControl]![Category1Select],True,False)))=False))
ORDER BY [>Product List].Item, [>Product List].Reference1
WITH OWNERACCESS OPTION;