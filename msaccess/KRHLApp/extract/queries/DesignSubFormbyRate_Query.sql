SELECT Sum([MIS Hours].Hours) AS SumOfHours, [DesignSubFormCurrentbyRate Query].CurrentDesignCost, [DesignSubFormPreviousbyRate Query].PreviousDesignCost, Min([DesignSubFormPreviousbyRate Query].PreviousDate) AS MinofDate, [Invoice Report Payments Total].ID, [Invoice Report Payments Total].SumOfAmount, [Invoice Report Design Invoices Total].SumOfInvoiceAmount, IIf([Date]>=Forms!Sales!FromDate And [Date]<=Forms!Sales!toDate,"Current Period","Previous Periods") AS ThePeriod, Previousday(Forms!Sales!fromdate) AS maxofdate, [>Design Rate].DesignRate, Sum([Hours]*[DesignRate]) AS DesignCost
FROM ((((([>Jobs] LEFT JOIN [Invoice Report Design Invoices Total] ON [>Jobs].Key=[Invoice Report Design Invoices Total].Job) LEFT JOIN [Invoice Report Payments Total] ON [>Jobs].Key=[Invoice Report Payments Total].Job) LEFT JOIN [MIS Hours] ON [Invoice Report Design Invoices Total].Job=[MIS Hours].[Job ID]) LEFT JOIN [DesignSubFormCurrentbyRate Query] ON [>Jobs].Key=[DesignSubFormCurrentbyRate Query].Key) LEFT JOIN [DesignSubFormPreviousbyRate Query] ON [>Jobs].Key=[DesignSubFormPreviousbyRate Query].Key) LEFT JOIN [>Design Rate] ON [MIS Hours].Employee=[>Design Rate].Designer
WHERE ((([>Jobs].Key)=forms!Sales!thejobname) And (([MIS Hours].Date)<=forms!sales!Todate))
GROUP BY [DesignSubFormCurrentbyRate Query].CurrentDesignCost, [DesignSubFormPreviousbyRate Query].PreviousDesignCost, [Invoice Report Payments Total].ID, [Invoice Report Payments Total].SumOfAmount, [Invoice Report Design Invoices Total].SumOfInvoiceAmount, IIf([Date]>=Forms!Sales!FromDate And [Date]<=Forms!Sales!toDate,"Current Period","Previous Periods"), [>Design Rate].DesignRate
ORDER BY IIf([Date]>=Forms!Sales!FromDate And [Date]<=Forms!Sales!toDate,"Current Period","Previous Periods") DESC , [>Design Rate].DesignRate;