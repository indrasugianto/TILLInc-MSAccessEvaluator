SELECT DISTINCTROW [>Jobs].ID AS Job, [>Jobs].Key, IIf(InStr([Phase],"Complete")<>0,[Phase],IIf([estimate] Or [designJob],[Phase],[ProductionPhase])) AS Currently, SaleorAmountorTotal.Total AS [Sale or Proposal], IIf([DesignJob] And Not [estimate],"Design",IIf([Estimate] And Not [designjob],"Estimate",IIf([Estimate] And [designjob],"Design Estimate",""))) AS [Job Type], IIf([Family],"Parent",IIf(nnez([>Jobs].Parent)<>0,"Child","")) AS [Parent/Child], [>Jobs].DesignJob, [>Jobs].Delivered, [>Jobs].Closed, [>Jobs].Customer, [>Jobs].Estimate, [>Jobs].Owner, [>Jobs].Completed
FROM ([>Jobs] LEFT JOIN [>Settings] ON [>Jobs].ProductionPhase=[>Settings].Phase) LEFT JOIN SaleorAmountorTotal ON [>Jobs].Key=SaleorAmountorTotal.Key
WHERE ((([>Jobs].ID) Is Not Null) And ((IIf(InStr([Phase],"Complete")<>0,[Phase],IIf([estimate] Or [designJob],[Phase],[ProductionPhase]))) Is Not Null) And (([>Jobs].Owner)=False) And ((IIf(Forms!Sales.SelectPartnerManager,IIf([Managedby]=Forms!Sales.PartnerManagerSelection Or [Specifiedby]=Forms!Sales.PartnerManagerSelection,True,False),True))=True) And ((IIf(InStr(Forms!Sales!viewClosed,"Open")<>0 And Not [Closed] Or InStr(forms!Sales!ViewClosed,"Closed")<>0 And [Closed],True,False))=True) And ((IIf(InStr(forms!sales!JobView,"all")<>0,True,IIf(InStr(forms!sales!JobView,"Design")<>0 And [DesignJob],True,IIf(InStr(Forms!sales!JobView,"Estimate")<>0 And [Estimate],True,False))))=True))
ORDER BY IIf([DesignJob] And Not [estimate],"Design",IIf([Estimate] And Not [designjob],"Estimate",IIf([Estimate] And [designjob],"Design Estimate",""))), [>Settings].PhaseSort, IIf(nnez([Completed])<>0,[maxofthedate],IIf([Estimate] Or [designjob],[Preliminary],#1/1/2099#)) DESC , [>Jobs].ID;