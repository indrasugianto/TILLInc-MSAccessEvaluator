Global g_FormCNC_SelectAll
Global g_FormCNC_SubAssembly
Global g_FormCNC_ToSubassembly
Global g_FormCNC_ToSequence
Global g_FormCNC_FromSequence
Global g_FormCNC_FromSubassembly
Global g_FormCNC_CNCRecord
Global g_FormProducts_ControlName
Global g_FormProducts_ProductType
Global g_FormProducts_ProductCategorySort
Global g_FormProducts_OptionCategorySort
Global g_FormProducts_DesignCategorySort
Global g_FormProducts_PartCategorySort
Global g_FormProducts_ProductRecord
Global g_FormProducts_OptionRecord
Global g_FormProducts_DesignRecord
Global g_FormProducts_PartRecord
Global g_FormProcesses_CategorySort
Global g_FormMaterial_StandardMaterials
Global g_FormMaterial_CategorySort As String
Global g_FormMaterial_Record As Single
Option Compare Database   'Use database order for string comparisons


Function SettingCurrentSetup()

SetMyDB
Dim myset As DAO.Recordset
Set myset = mydb.OpenRecordset("Select * from [>Product Lists] Where Not [Archive] and nnen(ProductList)<>''Order by ProductList", dbOpenSnapshot, dbSeeChanges)
If myset.RecordCount = 0 Then
    MsgBox "There are no current lists to view"
    Exit Function
End If
SetLocalVariable "Form_ProductList_ProductListName", myset!Key
SetLocalVariable "Form_ProductList_Archive", ""
Form_ProductList.ProductListName = myset!Key
Form_ProductList.ProductListName_AfterUpdate

End Function



Function SettingArchiveSetup()

SetMyDB
Dim myset As DAO.Recordset
Set myset = mydb.OpenRecordset("Select * from [>Product Lists] Where [Archive] and NNEN(ProductList)<>'' Order by ProductList", dbOpenSnapshot, dbSeeChanges)
If myset.RecordCount = 0 Then
    MsgBox "There are no archived lists to view"
    Exit Function
End If

SetLocalVariable "Form_ProductList_ProductListName", myset!Key
SetLocalVariable "Form_ProductList_Archive", "Yes"
Form_ProductList.ProductListName = myset!Key
Form_ProductList.ProductListName_AfterUpdate

End Function


Public Function ArchiveList()

On Error Resume Next
Forms!productlistmaster!ProductListControl.Repaint
SetMyDB
Dim myset As DAO.Recordset
Set myset = mydb.OpenRecordset("Select * from [>Product Lists] where [Key] = " & Form_ProductList.ProductListName, dbOpenDynaset, dbSeeChanges)
If NNEZ(myset!Archive) <> 0 Then
    If MessageOKCancel("This List is already Archived.  Do you want to make it current?") Then
        Exit Function
    Else
        myset.Edit
        myset!Archive = False
        myset.Update
        SetLocalVariable "Form_ProductList_ProductListName", myset!Key
        SetLocalVariable "Form_ProductList_Archive", ""
        Form_ProductList.ProductListName = myset!Key
        Form_ProductList.ProductListName_AfterUpdate
        Exit Function
    End If
End If
If MessageOKCancel("Are you sure you want to archive this Product List?") Then Exit Function
myset.Edit
myset!Archive = True
myset.Update
SetLocalVariable "Form_ProductList_ProductListName", myset!Key
SetLocalVariable "Form_ProductList_Archive", "Yes"
Form_ProductList.ProductListName = myset!Key
Form_ProductList.ProductListName_AfterUpdate

End Function